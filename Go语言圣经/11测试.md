
1. [go test](#go-test)
2. [测试函数](#测试函数)
3. [基准测试](#基准测试)


## go test 




## 测试函数



## 基准测试

**Benchmark**

基准测试是测量一个程序在固定工作负载下的性能。但是以Benchmark为前缀名，并且带有一个 *testing.B 类型的参数； *testing.B 参数除了提供和 *testing.T 类似的方法，还有额外一些和性能测量相关的方
法。它还提供了一个整数N，用于指定操作执行的循环次数。


1. 安装benchstat

```go
go install golang.org/x/perf/cmd/benchstat@latest
```


```go
go test -run=none -bench=Fib -count=10 > old.txt

go test -run=none -bench=FibFast -count=10 > new.txt

benchstat old.txt new.txt
```
给-run 选项传递了字符串"none"，来保证在运行制订的基
准测试函数之前没有单元测试会被运行。这两个选项都可以接受正则表达式，来决定需要运行哪
些测试。



main.go
```go
package main


func Fib(n int) int {
	if n < 2 {
		return n
	}
	return Fib(n-1) + Fib(n-2)
}

func FibFast(n int) int {
	if n < 2 {
		return n
	}
	a, b := 0, 1
	for i := 2; i <= n; i++ {
		a, b = b, a+b
	}
	return b
}
```

fib_test.go
```go

```




```bash
➜  89-benchmark git:(main) ✗ go test -benchmem -run=none -bench=Fib -count=10 | tee old.txt
➜  89-benchmark git:(main) ✗ go test -benchmem -run=none -bench=Fib -count=10 | tee new.txt

➜  89-benchmark git:(main) ✗ benchstat old.txt new.txt
goos: darwin
goarch: arm64
pkg: github.com/xilepeng/100-go-mistakes/89-benchmark
cpu: Apple M4
             │   old.txt   │               new.txt                │
             │   sec/op    │   sec/op     vs base                 │
Fib10-10       242.9n ± 2%
FibFast10-10   5.591n ± 2%   5.619n ± 3%       ~ (p=0.631 n=10)
geomean        36.85n        5.619n       +0.50%                ¹
¹ benchmark set differs from baseline; geomeans may not be comparable


GOSSAFUNC=FIB go build
```